%{
	#include "y.tab.h"
	#include <string.h>
	#include <stdlib.h>
	void yyerror(char* );
	size_t num_len = 10;
	size_t var_len = 16;
	char* number;
%}

under_score [_]+
digit_first [0-9]+[a-zA-Z|0-9|_]+
id [a-zA-Z_][a-zA-Z0-9_]*
int [0-9]+
double ([0-9]*\.?[0-9]+)([eE][-+]?[0-9]+)?

%%

"if"		{ return IF; }
"then"		{ return THEN; }
"else"		{ return ELSE; }
"end"		{ return END; }
"while"		{ return WHILE; }
"def"		{ return DEF; }
"local"		{ return LOCAL; }
"print"		{ return PRINT; }

"="			{ return *yytext; }							/* assign */
">"			{ return *yytext; }							/* relop > */
"<"			{ return *yytext; }							/* relop < */
"<="		{ return LQ; }								/* relop <= */
">="		{ return GQ; }								/* relop >= */
"=="		{ return EQ; }								/* eqlop == */
"!="		{ return NQ; }								/* eqlop != */
"+"			{ return *yytext; }							/* plus */
"-"			{ return *yytext; }							/* minus */
"*"			{ return *yytext; }							/* multi */
"/"			{ return *yytext; }							/* div */


{int}			{	/* integer */
					if(strlen(yytext) > 10) // only 10 size
					{
						number = (char*)malloc(sizeof(char) * 11);
						strncpy(number, &yytext[yyleng - num_len], num_len);
						yylval.val = atoi(number); 
						free(number);
					}
					else 
					{
						yylval.val = atoi(yytext); 
					}
					return INTEGER; 
				
				}	
{double}		{ /* double */
					if(strlen(yytext) > 10)
					{
						number = (char*)malloc(sizeof(char) * 11);
						strncpy(number, &yytext[yyleng - num_len], num_len);
						yylval.dval = atof(number);
					}
					else
					{
					
					}
					yylval.dval = atof(yytext); return DOUBLE;
				}  
{digit_first}	  return yytext[0];	
{under_score}	  return yytext[0];
{id}			{ return VAR; }
[ \t]			;													/* ignore whitespace */
[\n]			{ return *yytext; }
.		   	    yyerror("lexical error : Unknown character"); 		/* lexical error */ 
%%
